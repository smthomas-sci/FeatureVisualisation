<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FeatureVisualisation</title>

    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
    <link href="stylesheet.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

</head>


<body>

<!-- OVERLAY FOR LOADING-->
<div class="loader">
    <h4>Loading Images (110MB) ...</h4>
</div>
<!------------------------>

<h1>Feature Visualisation</h1>

<div class="paragraphs">
    <p>
        Feature Visualisation (or Filter Visualisation), is an interpretability method for understanding CNNs.
        It works by using gradient descent to iteratively generate an input image that maximises the output of a
        given neuron(s). This methods has been widely studied since 2015, and although many would consider the problem
        solved, a brief exploration of both formal and informal publications should raise most people's
        suspicions of a reproducibility problem. Results vary depending on frameworks (Theano, Caffe, Tensorflow,
        Keras and PyTorch) as well as network architectures (Inception V1-V3, ResNet-50, VGG16 etc).

    </p>
    <p>
        In wanting to develop interpretability methods I've attempted to reproduce the work of various
        researchers, culminating in my own <a href="https://github.com/smthomas-sci/FeatureVisualisation">FeatureVisualisation</a>
        module using Keras. In doing so I've discovered first-hand the challenges facing reproducibility, specifically
        the difficulty in transferring methods to other networks. In my case, I've kept to the narrow path of intuition
        that we have for deep learning, focusing specifically on the straight-forward yet powerful VGG-16<sup><a href="#one">1</a></sup>
        network. The following are optimised input images for the main pooling layers after two convolutional layers.
    </p>

</div>



<div id="filter_container">


    <div class="flex_containter">
        <div class="filter_block" id="block1_pool">
            <h3>block1_pool</h3>
            <!-- all divs will append here -->
        </div>

        <div class="viewer" id="viewer_block1">
            <p class="viewer_filter_name" id="vfn_block1">Filter : NA</p>
            <img id="viewer_img_block1" src="./images/block1_pool/block1_pool_filter_0.png" alt="">
        </div>
    </div>

    <div class="flex_containter">
        <div class="filter_block" id="block2_pool">
            <h3>block2_pool</h3>
            <!-- all divs will append here -->
        </div>

        <div class="viewer" id="viewer_block2">
            <p class="viewer_filter_name" id="vfn_block2">Filter : NA</p>
            <img id="viewer_img_block2" src="./images/block2_pool/block2_pool_filter_0.png" alt="">
        </div>
    </div>


    <div class="flex_containter">
        <div class="filter_block" id="block3_pool">
            <h3>block3_pool</h3>
            <!-- all divs will append here -->
        </div>

        <div class="viewer" id="viewer_block3">
            <p class="viewer_filter_name" id="vfn_block3">Filter : NA</p>
            <img id="viewer_img_block3" src="./images/block3_pool/block3_pool_filter_167.png" alt="">
        </div>
    </div>


    <div class="flex_containter">
        <div class="filter_block" id="block4_pool">
            <h3>block4_pool</h3>
            <!-- all divs will append here -->
        </div>

        <div class="viewer" id="viewer_block4">
            <p class="viewer_filter_name" id="vfn_block4">Filter : NA</p>
            <img id="viewer_img_block4" src="./images/block4_pool/block4_pool_filter_167.png" alt="">
        </div>
    </div>


    <div class="flex_containter">
        <div class="filter_block" id="block5_pool">
            <h3>block5_pool</h3>
            <!-- all divs will append here -->
        </div>

        <div class="viewer" id="viewer_block5">
            <p class="viewer_filter_name" id="vfn_block5">Filter : NA</p>
            <img id="viewer_img_block5" src="./images/block5_pool/block5_pool_filter_167.png" alt="">
        </div>
    </div>




</div>


<div class="paragraphs">
    <h3>References:</h3>
    <ol>
        <li id="one">Simonyan, K., & Zisserman, A. (2014). Very deep convolutional networks for large-scale image recognition. arXiv preprint arXiv:1409.1556.</li>
    </ol>
</div>


<!-- SCRIPTS -->
<script>
    $(window).load(function() {
        $(".loader").fadeOut("slow");
    });
</script>

<script>

    String.prototype.format = function() {
        a = this;
        for (k in arguments) {
            a = a.replace("{" + k + "}", arguments[k])
        }
        return a
    }

    // block1_pool
    let target_div = document.getElementById("block1_pool");
    for(var i=0; i < 64; i++) {

        // Add new image to this div
        let image = document.createElement('img');
        image.src = "./images/block1_pool/block1_pool_filter_{0}.png".format(i);
        image.id = "r" + i;
        image.className = "tile";

        target_div.appendChild(image);
        //    Now add tooltip to div
        let tooltip = document.createElement('h1');
        tooltip.className = "tooltip";
        tooltip.innerHTML = "Filter : {0}".format(i);
        image.appendChild(tooltip);
    }

    // block2_pool
    target_div = document.getElementById("block2_pool");
    for(var i=0; i < 128; i++) {

        // Add new image to this div
        let image = document.createElement('img');
        image.src = "./images/block2_pool/block2_pool_filter_{0}.png".format(i);
        image.id = "r" + i;
        image.className = "tile";

        target_div.appendChild(image);
        //    Now add tooltip to div
        let tooltip = document.createElement('h1');
        tooltip.className = "tooltip";
        tooltip.innerHTML = "Filter : {0}".format(i);
        image.appendChild(tooltip);
    }


    // block3_pool
    target_div = document.getElementById("block3_pool");
    for(var i=0; i < 256; i++) {

        // Add new image to this div
        let image = document.createElement('img');
        image.src = "./images/block3_pool/block3_pool_filter_{0}.png".format(i);
        image.id = "r" + i;
        image.className = "tile";

        target_div.appendChild(image);
        //    Now add tooltip to div
        let tooltip = document.createElement('h1');
        tooltip.className = "tooltip";
        tooltip.innerHTML = "Filter : {0}".format(i);
        image.appendChild(tooltip);
    }

    // block4_pool
    target_div = document.getElementById("block4_pool");
    for(var i=0; i < 512; i++){

        // Add new image to this div
        let image = document.createElement('img');
        image.src = "./images/block4_pool/block4_pool_filter_{0}.png".format(i);
        image.id = "r" + i;
        image.className = "tile";

        target_div.appendChild(image);
        //    Now add tooltip to div
        let tooltip = document.createElement('h1');
        tooltip.className = "tooltip";
        tooltip.innerHTML = "Filter : {0}".format(i);
        image.appendChild(tooltip);

    }
    // block5_pool
    target_div = document.getElementById("block5_pool");
    for(var i=0; i < 512; i++){

        // Add new image to this div
        let image = document.createElement('img');
        image.src = "./images/block5_pool/block5_pool_filter_{0}.png".format(i);
        image.id = "r" + i;
        image.className = "tile";

        target_div.appendChild(image);
        //    Now add tooltip to div
        let tooltip = document.createElement('h1');
        tooltip.className = "tooltip";
        tooltip.innerHTML = "Filter : {0}".format(i);
        image.appendChild(tooltip);

    }

</script>

<script>
    var orig_img = "./images/block5_pool/block5_pool_filter_167.png";
    $(".tile").on({

        mouseenter: function() {
            var src = $(this).attr('src');
            var block = src.split("/")[2].split("_")[0].substr(-1);
            console.log(block);
            var i = $(this).attr('id').substring(1);

            $("#viewer_img_block" + block).prop("src", src);
            $("#vfn_block" + block).text("Filter : " + (Number(i)+1));
        }
    })
</script>

</body>
</html>